# üöÄ ServiceFlow ‚Äî Backend-—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∞–º–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–∞–Ω–∏–∏

**ServiceFlow** ‚Äî –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π backend-—Å–µ—Ä–≤–∏—Å –Ω–∞ FastAPI, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.  
–ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è IT-–ø–æ–¥–¥–µ—Ä–∂–∫–∏, helpdesk-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤, HR-–∑–∞—è–≤–æ–∫ –∏ –¥—Ä—É–≥–∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ç–∏–∫–µ—Ç-—Å–∏—Å—Ç–µ–º –∫–æ–º–ø–∞–Ω–∏–∏.

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–ø–æ–¥—Ö–æ–¥ –∫ backend-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ,
- —Ä–æ–ª–µ–≤—É—é –º–æ–¥–µ–ª—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞,
- —Å—Ç—Ä–æ–≥—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É —Å—Ç–∞—Ç—É—Å–æ–≤,
- –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ Docker-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É,
- —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ API-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

---

## üß© TL;DR

- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∑–∞—è–≤–æ–∫  
- –†–æ–ª–∏: **ADMIN / AGENT / EMPLOYEE**  
- –°—Ç–∞—Ç—É—Å—ã: **NEW ‚Üí IN_PROGRESS ‚Üí DONE / CANCELED**  
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ API-–∫–ª—é—á–∞–º  
- PostgreSQL + Alembic  
- Docker Compose  
- –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã (Pytest)

---

## üèõ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

ServiceFlow –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π layered-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞:

Client ‚Üí FastAPI Routers ‚Üí Services ‚Üí ORM ‚Üí PostgreSQL

```mermaid
flowchart TB
    Client[Client\n(Web / Bot)]
    Routers[FastAPI Routers]
    Services[Services\n(Business Logic)]
    ORM[SQLAlchemy ORM]
    DB[(PostgreSQL)]

    Client --> Routers
    Routers --> Services
    Services --> ORM
    ORM --> DB

    Auth[API Key Auth] --> Routers
    Logs[Audit Logs] --> Services
    Alembic[Alembic Migrations] --> DB
```



–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:
- API-Key –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –∞—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π
- Alembic-–º–∏–≥—Ä–∞—Ü–∏–∏
- seed-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö


---

## üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–º–∏ –∑–∞—è–≤–∫–∞–º–∏ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–∞–º–∏
- —Å—Ç—Ä–æ–≥–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤
- —Ä–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–∞:
  - **ADMIN** ‚Äî –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–∏—Å—Ç–µ–º—ã
  - **AGENT** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ –∑–∞—è–≤–æ–∫
  - **EMPLOYEE** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫
- –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ API-–∫–ª—é—á–∞–º (X-API-Key)
- –∞—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- UUID / public_id –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Alembic
- Docker –∏ Docker Compose
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã (Pytest)

---

## üß± ERD (—Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)

–û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏:
- users
- requests
- audit_logs
- roles

–°–≤—è–∑–∏:
- users (1) ‚Üí (N) requests
- users (1) ‚Üí (N) audit_logs

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- UUID –∫–∞–∫ primary key
- public_id –∫–∞–∫ –≤–Ω–µ—à–Ω–∏–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä

[–ó–î–ï–°–¨ –ë–£–î–ï–¢ –ö–ê–†–¢–ò–ù–ö–ê: ERD –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö]

---

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- Python 3
- FastAPI
- SQLAlchemy 2.0
- PostgreSQL
- Alembic
- Docker / Docker Compose
- Pytest

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

app/
  core/          –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏  
  routers/       HTTP-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã API  
  schemas/       Pydantic-—Å—Ö–µ–º—ã  
  models/        ORM-–º–æ–¥–µ–ª–∏  
  services/      –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞  

alembic/         –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö  
tests/           –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã  

[–ó–î–ï–°–¨ –ë–£–î–ï–¢ –ö–ê–†–¢–ò–ù–ö–ê: –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞]

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker
- Docker Compose

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

git clone https://github.com/RiobVO/ServiceFlow.git  
cd ServiceFlow  

### 2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è

copy .env.example .env

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å

docker compose up --build

### 4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

docker compose exec backend alembic upgrade head

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
- API: http://localhost:8000
- Swagger UI: http://localhost:8000/docs

---

## üîë –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- DATABASE_URL_POSTGRES
- API_KEY
- ADMIN_BOOTSTRAP_KEY

–ü—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `.env.example`.

---

## üì° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏

POST /requests  
X-API-Key: EMPLOYEE_API_KEY  

{
  "title": "–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç VPN",
  "description": "–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç"
}

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏

PATCH /requests/{id}/status  
X-API-Key: AGENT_API_KEY  

{
  "status": "IN_PROGRESS"
}

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

docker compose exec backend pytest

---

## üõ† –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

- —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
- healthcheck —Å–µ—Ä–≤–∏—Å–∞
- —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ API-–∫–ª—é—á–µ–π –∏ endpoint –¥–ª—è –∏—Ö —Å–±—Ä–æ—Å–∞
- —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π
- ERD –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- web-–∞–¥–º–∏–Ω–∫–∞ –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram-–±–æ—Ç–æ–º

---

## üë§ –ê–≤—Ç–æ—Ä

Elyor Yusupov  
GitHub: https://github.com/RiobVO
